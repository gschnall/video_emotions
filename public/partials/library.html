<h1> Your <i class="fa fa-lg fa-picture-o"></i> Library </h2>

  <!-- <form id="video-uploader" action=" {{ '/videos/create/' + video.userEmail }}" enctype="multipart/form-data" method="post">
    <div class="green accent-4"><a ui-sref="create"><i class="fa fa-video-camera">  New Video <input onchange="this.form.submit()" type="file" name="upload" mutiple="multiple">  </i></a></div>
  </form> -->

  <form id="video-uploader" action=" {{ '/videos/create/' + video.userEmail }}" enctype="multipart/form-data" method="post">
    <div class="file-field input-field">
      <div class="btn">
        <span>Upload A New Image</span>
        <input type="file" name="upload" id="file_input" multiple="multiple" onchange="this.form.submit()">
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate blue-text text-darken-2" type="text" placeholder="Once an Image is uploaded you can Analyze it for Content and Emotion">
      </div>
    </div>
  </form>
<br>
<ul class="collection">
    <li ng-repeat="v in video.videos.slice().reverse()" ng-hide="v.videoUrl.split('.')[1] == true" class="collection-item avatar">
    <span style="font-size:22px"class="bold title">{{ v.title }} </span>

      <br><br>
    <img class="circle" ng-src="{{ v.videoThumbnailUrl }}" />
      <!-- show analyze video Link if not analyzed -->
      <button ng-hide="v.analyzed" class="btn waves-effect waves-light amber darken-2" ng-click="video.analyze(v)" type="button" name="button"><i class="fa fa-eye"> Analyze Image</i></button>
      <!-- Hide analysis Link if not there -->
      <button ng-show="v.analyzed" class="btn waves-effect waves-light green" ng-click="video.view(v)" type="button" name="button"><i class="fa fa-bar-chart-o"> View Analysis</i></button>
      <button ng-click="video.destroy(v._id)" class="waves-effect waves-light btn-large secondary-content red darken-1 flat"><i class="fa fa-lg fa-trash-o"></i></button>
    </li>
  </ul>

  <script type="text/javascript">
  (function() {
  document.getElementById("file_input").onchange = function(){
      var files = document.getElementById("file_input").files;
      var file = files[0];
      if(file == null){
          alert("No file selected.");
      }
      else{
          get_signed_request(file);
      }
  };

  function get_signed_request(file){
      var xhr = new XMLHttpRequest();
      xhr.open("GET", "/sign_s3?file_name="+file.name+"&file_type="+file.type);
      xhr.onreadystatechange = function(){
          if(xhr.readyState === 4){
              if(xhr.status === 200){
                  var response = JSON.parse(xhr.responseText);
                  upload_file(file, response.signed_request, response.url);
              }
              else{
                  alert("Could not get signed URL.");
              }
          }
      };
      xhr.send();
  }

  function upload_file(file, signed_request, url){
    var xhr = new XMLHttpRequest();
    xhr.open("PUT", signed_request);
    xhr.setRequestHeader('x-amz-acl', 'public-read');
    xhr.onerror = function() {
        alert("Could not upload file.");
    };
    xhr.send(file);
}


})();
  </script>
